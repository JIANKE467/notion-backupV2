name: Notion Workspace Backup

on: schedule: - cron: '0 2 * * *' # daily at 02:00 UTC workflow_dispatch: {}

jobs: backup: runs-on: ubuntu-latest steps: - name: Checkout uses: actions/checkout@v4

- name: Setup Node
    uses: actions/setup-node@v4
    with:
      node-version: 18

  - name: Install deps
    run: npm ci

  - name: Run Notion backup
    env:
      NOTION_API_TOKEN: ${{ secrets.NOTION_API_TOKEN }}
    run: node src/index.js

  - name: Commit changes
    run: |
      git config user.name "github-actions[bot]"
      git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
      git add -A
      git commit -m "notion backup: $(date -u +'%Y-%m-%dT%H:%M:%SZ')" || echo "no changes"
      git push