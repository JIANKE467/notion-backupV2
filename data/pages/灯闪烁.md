在点灯的基础上加一个延时函数（延时函数用单片机烧录软件生成）

### 原理

写一个死循环，在该循环内执行：开灯，等待，关灯的操作

等待由一个函数（延时函数）实现，该函数由烧录软件生成

### 实现代码

```c
#include <REGX52.H>
#include <INTRINS.H>
void Delay1000ms(void)	//@11.0592MHz
{
	unsigned char data i, j, k;

	_nop_();
	_nop_();
	i = 43;
	j = 6;
	k = 203;
	do
	{
		do
		{
			while (--k);
		} while (--j);
	} while (--i);
}


void main()
{
	while(1)
	{
		P2=0x00;
		Delay1000ms();
		P2=0xFF;
		Delay1000ms();
	}
}
```

这里涉及两个头文件，详见：几个头文件作用 

包含<INTRINS.H>的原因是延时函数使用了函数_nop_

延时函数的频率取决于主板晶振频率

### 异常问题

现象：要求隔1000毫秒闪烁，实际闪烁间隔不是1000毫秒

解决：8051指令集选最老的STC-Y1，选其他的延时时间就不对了

## 拓展

可以让等待时间任意设置而不重新定义函数

方法：用烧录软件生成1毫秒的延迟函数，给延迟函数添加形参（毫秒数），再延迟函数内套一个形参次数的循环

